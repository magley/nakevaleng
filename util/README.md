```
utility data structures and algorithms
```

```
filename
    Generating and parsing filenames in accordance with the filename format used by nakevaleng. Format specification:

    sstable

        databasename-level-run-filetype.db

            databasename
                - name of the database
                - the application layer could specify a special name
                - otherwise if we're using nakevaleng directly, set it to "nakevaleng"
            level
                - level in the lsm tree
                - valid values are [1, N], where N is specified through a config file
                - level 0 is "reserved" for memtables
            run
                - ordinal number of the sstable on the given level
                - valid values are [0, M], where M is maximum number of tables before compaction
            filetype
                - what the specific table holds
                - not to be confused with the more general file type term, determined by extension
                - possible values are bounded by the FileType enum defined in filename.go

        [example]

            nakevaleng-1-0-data.db
                created by the core engine
                on level 1 (first level in the lsm tree)
                on run 0 (first table on level 1)
                stores the data segment (i.e. actual key-value pairs)
            nakevaleng-1-0-filter.db
                created by the core engine
                on level 1 (first level in the lsm tree)
                on run 0 (first table on level 1)
                stores the bloomfilter generated by the keys from 'data'
            myapplication-2-5-summary.db
                created by an app which decided that db files are prefixed by 'myapplication'
                on level 2 (second level in the lsm tree)
                on run 5 (sixth table on level 2)
                stores the merkletree generated from the data

    wal

        databasename-logno.log

            databasename
                - the same as sstable's databasename
            logno
                - ordinal number of the log file in the wal
                - valid values range from 0

        [example]

            nakevaleng-0.log
            nakevaleng-1.log
                ...
```
```go

// Create table filename from params

fname1 := filename.Table("data/", "nakevaleng", 1, 0, filename.TypeData)
fname2 := filename.Table("data/", "nakevaleng", 1, 0, filename.TypeFilter)
fname3 := filename.Table("data/", "nakevaleng", 1, 1, filename.TypeSummary)
fmt.Println(fname1)
fmt.Println(fname2)
fmt.Println(fname3)
os.Create(fname1)
os.Create(fname2)
os.Create(fname3)

// Create next run on level 1

nextRun := filename.GetLastRun("data/", "nakevaleng", 1) + 1
nextFnm := filename.Table("data/", "nakevaleng", 1, nextRun, filename.TypeData)
fmt.Println(nextFnm)
os.Create(nextFnm)

// Create next level (level 2)

nextLvl := filename.GetLastLevel("data/", "nakevaleng") + 1
nextRun2 := filename.GetLastRun("data/", "nakevaleng", nextLvl) + 1

nextFnm2 := filename.Table("data/", "nakevaleng", nextLvl, nextRun2, filename.TypeData)
fmt.Println(nextFnm2)
os.Create(nextFnm2)

// Querying

dbname, lvl, rn, ftype := filename.Query(nextFnm2)
fmt.Println(dbname == "nakevaleng", lvl == nextLvl, rn == nextRun2, ftype == filename.TypeData)

// Create log filename from params

fnamelog1 := filename.Log("data/log/", "nakevaleng", 0)
fnamelog2 := filename.Log("data/log/", "nakevaleng", 1)
fmt.Println(fnamelog1)
fmt.Println(fnamelog2)
os.Create(fnamelog1)
os.Create(fnamelog2)

// Create next log filename

logNo3 := filename.GetLastLog("data/log/", "nakevaleng") + 1
fnamelog3 := filename.Log("data/log/", "nakevaleng", logNo3)
fmt.Println(fnamelog3)
os.Create(fnamelog3)

// Querying

dbname, logno, _, ftype := filename.Query(fnamelog3)
fmt.Println(dbname == "nakevaleng", logno == logNo3, ftype == filename.TypeLog)

```